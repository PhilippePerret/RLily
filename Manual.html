<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<style>
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>
<title>RLily (Ruby to Lilypond)</title>

</head>
<body>
<h1>RLily (Ruby to Lilypond)</h1>

<ul>
<li><a href="#introduction">Introduction/Présentation</a></li>
<li><a href="#write_code_partition">Écriture du code partition</a>

<ul>
<li><a href="#write_notes">Écriture des notes</a></li>
<li><a href="#les_barres_de_mesure">Écrire des barres de mesure</a></li>
<li><a href="#define_octave">Définition de l'octave</a></li>
<li><a href="#define_cle">Définir la clé</a></li>
<li><a href="#write_chord">Écrire un accord</a></li>
<li><a href="#write_triolet">Écrire un triolet</a></li>
<li><a href="#write_a_loctave">Écrire un passage à l'octave (8v---)</a></li>
</ul>
</li>
<li><a href="#masquer_element_score">Masquer des éléments de la partition</a></li>
<li><a href="#graphic_elements">Éléments graphiques</a>

<ul>
<li><a href="#ecrire_une_marque">Écrire une marque</a></li>
<li><a href="#ecrire_un_texte">Écrire un texte</a></li>
<li><a href="#entourer_note">Entourer une note d'un cercle</a></li>
</ul>
</li>
<li><a href="#mark_opus">Indication de l'opus</a></li>
<li><a href="#sous_titre">Sous-titre</a></li>
<li><a href="#armure">Indication de l'armure</a></li>
<li><a href="#mark_tempo">Indication du tempo</a></li>
<li><a href="#mark_instrument">Indication de l'instrument</a></li>
<li><a href="#define_espace_avant_premier_systeme">Définir l'espace entre titre et premier système</a></li>
<li><a href="#define_systeme_spacing">Définir l'espacement entre les systèmes</a></li>
<li><a href="#define_espace_entre_portees">Définir l'espacement entre les portées (du piano)</a></li>
<li><a href="#define_score_size">Définir la taille de la partition (notes/portées)</a></li>
<li><a href="#set_options">Réglage des options</a>

<ul>
<li><a href="#option_show_spacing">Demander l'affichage des dimensions</a></li>
<li><a href="#option_slash_between_systemes">Ajouter un slash entre les systèmes</a></li>
</ul>
</li>
</ul>


<p><a name='introduction'></a></p>

<h1>Introduction présentation</h1>

<p><code>RLily</code> permet de construire rapidement une partition à l'aide de Lilypond, en produisant un code façon ruby.</p>

<p>Dans TextMate, avec le Bundle RLily&nbsp;:</p>

<ol>
<li>Écrire le code en ruby (dans un fichier .rlily)</li>
<li>Taper <code>CMD + MAJ + P</code></li>
</ol>


<p>Et la partition est produite.</p>

<p>Pour le moment, cette partition est très simple, elle est produite pour le piano (clé de sol et clé de Fa) et ne supporte que les ajouts de notes (et autres marques du code normal de Lilypond comme les doigtés, les liaisons, les accords, etc.)</p>

<h2>Quick référence pour la création</h2>

<ol>
<li>Créer le fichier RLily (.rlily) qui va contenir le code pour la partition (c'est le "fichier source")</li>
<li>Définir les données du score (<a href="#donnees_generales">Données générales du score</a>)</li>
<li>Définir le contenu de chaque main avec <code>MD &lt;&lt; "&lt;notes&gt;"</code> et <code>MG &lt;&lt; "&lt;notes&gt;"</code></li>
</ol>


<p>La suite dépend de l'utilisation ou non du Bundle <code>Phil:RLily</code>. S'il est présent :</p>

<ol>
<li>Avec le fichier source activé, utiliser le menu <code>Produire la partition</code> (ou jouer le raccourci <code>CMD + MAJ + P</code>)</li>
</ol>


<p>Si le bundle n'est pas présent&nbsp;:</p>

<ol>
<li>Ouvrir le fichier <code>_rlily.rb</code></li>
<li>Définir la valeur de <code>SCORE_PATH</code> en mettant le path du fichier source</li>
<li>Runner <code>_rlily.rb</code> pour produire la partition</li>
</ol>


<h3>En cas d'échec</h3>

<p>Dans certains dossiers, les permissions peuvent manquer. Dans ce cas, le programme ouvre le fichier <code>.ly</code> dans TextMate (donc le fichier Lilypond que RLily produit), et il suffit alors de taper <code>CMD + R</code> pour produire la partition (si le Bundle Lilypond est installé).</p>

<p><a name="donnees_generales"></a></p>

<h2>Données générales du score</h2>

<p>Définir dans le code du fichier source (toutes les valeurs peuvent être omises) :</p>

<pre><code>SCORE::titre = "LE TITRE DU MORCEAU"
SCORE::compositeur = "LE COMPOSITEUR"
SCORE::armmure = "L'ARMURE ('A', 'B', etc.)"
SCORE::metrique = "4/4"
</code></pre>

<h2>Constantes utiles</h2>

<p>Le fichier <code>lib/music/constantes_textuelles.rb</code> contient des constantes textuelles utiles, pour marquer des barres, etc.</p>

<h2>Utilisation de la commande <code>rlily</code></h2>

<p>On peut construire une partition à l'aide de :</p>

<pre><code>rlily "path/to/file_partition.rb"
</code></pre>

<p>Pour que ça fonctionne, il faut que la commande <code>rlily</code> ait été définie :</p>

<pre><code>$ cd /usr/bin
$ sudo touch rlily
[Entrer mot de passe]
$ sudo chmod 0777 rlily
</code></pre>

<p>ci-dessous, vous devez remplacer <code>PATH/TO/RUBY2LILY/</code> par le path à votre dossier téléchargé de ruby2lily :</p>

<pre><code>$ sudo echo 'exec PATH/TO/RUBY2LILY/ruby2lily.rb "$@"' &gt; rlily
# $ sudo echo 'exec /Users/philippeperret/Programmation/Programmes/RLily/_rlily.rb "$@"' &gt; rlily
$ sudo chmod u+x rlily
</code></pre>

<p><a name='masquer_element_score'></a></p>

<h1>Masquer des éléments de la partition</h1>

<p>On peut utiliser la pseudo-commande <code>hide(&lt;element&gt;)</code> (cacher) pour masquer des éléments de la partition, barres de mesures, hampes, etc.</p>

<p><code>&lt;element&gt;</code> peut être&nbsp;:</p>

<pre><code>Un Symbole              :beam
Une liste de symboles   [:beam, :staff]
Le symbole spécial      :all
</code></pre>

<p>Quand <code>:all</code> est envoyé à <code>hide</code>, peut définir les éléments qui ne doivent pas être masqués à l'aide d'un second argument&nbsp;:</p>

<pre><code>hide( :all, { except: [&lt;liste de symboles&gt;] } )
</code></pre>

<p>Par exemple, pour masquer tout sauf les liaisons&nbsp;:</p>

<pre><code>hide( :all, { except: [:slur] } )
</code></pre>

<p>On utilise à l'inverse la pseudo-command <code>show(&lt;element&gt;)</code> pour que les éléments soient affichés à nouveau.</p>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; "c8 d e"
MD &lt;&lt; hide(:stem)
MD &lt;&lt; "f g a" # Les stems ne seront pas affichés
MD &lt;&lt; show(:stem)
MD &lt;&lt; "b c e" # Les stemps sont remises
</code></pre>

<p>On peut bien sûr indiquer tout sur une même ligne&nbsp;:</p>

<pre><code>MD &lt;&lt; "c8 d e #{hide(:stem)} f g a #{show(:stem)} b c e"
</code></pre>

<p><em>Note&nbsp;: Si ce qui est à remontrer avec <code>show</code> est identique à ce qui a été masqué avec <code>hide</code>, on peut simplement utiliser <code>show</code> sans arguments&nbsp;:</em></p>

<pre><code>MD &lt;&lt; "c8 d e"
MD &lt;&lt; hide([:stem, :staff])
MD &lt;&lt; "f g a" # Les stems et la portée ne seront pas affichés
MD &lt;&lt; show
MD &lt;&lt; "b c e" # Les stemps et la portée ré-apparaissent
</code></pre>

<p>Éléments qu'on peut masquer&nbsp;:</p>

<pre><code>    ÉLÉMENT                  CLÉ              EXEMPLE
----------------------------------------------------------------
TOUS                    :all  / :tous
Barres de mesure        :bar / :barre         hide(:bar)
Hampes (Stems)          :stem / :hampe        hide(:stem)
Silences (Rest)         :rest / :silence      hide(:rest)
Tête de notes           :head / :tete         hide(:head)
Liasons                 :slur / :liaison      hide(:slur)
Crochets                :beam / :crochet      hide(:beam)
Métrique                :metrique             hide(:metrique)
Clé                     :clef / :key          hide(:clef)
----------------------------------------------------------------
</code></pre>

<p><a name='graphic_elements'></a></p>

<h1>Éléments graphiques</h1>

<p><a name='ecrire_une_marque'></a></p>

<h2>Écrire une marque</h2>

<p><em>Note&nbsp;: une “marque” est plus visible, plus grosse qu'un texte. Pour écrire un “texte”, cf. <a href="#ecrire_un_texte">Écrire un texte</a>.</em></p>

<p>Utiliser la méthode <code>mark</code> pour placer une marque de répétition (pas de reprise, de répétition au sens de “répéter avec son groupe” par exemple).</p>

<pre><code>mark("&lt;notes&gt;", "&lt;texte de la marque&gt;"[, { options }] )
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; mark("c1 c", "Reprendre ce passage")
</code></pre>

<p>Par défaut, la marque est placé <strong>au centre de l'élément précédent et l'élément suivant.</strong> Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; mark("c1 c", "entre les deux")
</code></pre>

<p>… placera le "entre les deux" centré au-dessus de la barre séparant les deux mesures.</p>

<p>On peut demander que l'alignement se fasse à gauche ou à droite à l'aide du second argument de la méthode&nbsp;:</p>

<pre><code>MD &lt;&lt; mark("sur le premier", left: true)

MD &lt;&lt; mark("c4 c c c", "sur le deuxième", right: true)
</code></pre>

<p><a name='ecrire_un_texte'></a></p>

<h2>Écrire un texte</h2>

<p><em>Note&nbsp;: un “texte” est plus petit qu'une “Marque”. Pour écrire une marque (de répétition par exemple, cf. <a href="#ecrire_une_marque">Écrire une marque</a>).</em></p>

<p>On peut utiliser la méthode <code>write</code> (ou ses alias <code>ecrire</code> ou <code>texte</code>) pour écrire un texte au-dessus/en dessous d'une note.</p>

<p>Le premier argument doit être la note, le deuxième argument doit être le texte et un troisième argument Hash peut définir les options.</p>

<pre><code>ecrire( "&lt;note&gt;", "&lt;texte&gt;", {&lt;options&gt;} )
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; write( "c", 'c\'est un DO') + "d"
# =&gt; Écrira "C'est un DO" sur la note DO
</code></pre>

<h3>Placer le texte en dessous</h3>

<p>On utilise le second argument de l'appel à la méthode en définissant la clé <code>:up</code>. Si elle est fausse, le texte est marqué en dessous de la note.</p>

<p>Par exemple&nbsp;:</p>

<pre><code>MG &lt;&lt; texte('c', 'en dessous', { up: false } )
</code></pre>

<h3>Ne pas étirer le texte</h3>

<p>Par défaut, la note suivante sera placée à la fin du texte. Pour éviter ce comportement, on peut ajouter <code>:strech =&gt; false</code> (ou <code>strech: false</code>) dans les options.</p>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; write("c", "Un texte qui couvrira les autres notes", {strech: false} )
</code></pre>

<p><em>Noter que cette option ne s'applique qu'au texte visé. Les textes suivants seront à nouveau “étirant”.</em></p>

<p><a name='entourer_note'></a></p>

<h2>Entourer une note d'un cercle</h2>

<p>Il suffit de placer <code>\circle</code> devant, par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; "c \\circle d e" # la note Ré sera entourée
</code></pre>

<p><a name="mark_opus"></a></p>

<h2>Indication de l'opus</h2>

<pre><code>SCORE::opus = &lt;opus&gt;
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>SCORE::opus = 13
</code></pre>

<p><em>Note&nbsp;: Ne pas mettre "Opus" ou "Op."</em></p>

<p><a name='sous_titre'></a></p>

<h2>Sous-titre</h2>

<p>Pour indiquer un sous-titre&nbsp;:</p>

<pre><code>SCORE::sous_titre = "&lt;le sous-titre&gt;"
</code></pre>

<p><a name="armure"></a></p>

<h2>Indication de l'armure</h2>

<pre><code>SCORE::armure = &lt;armure&gt;
</code></pre>

<p><code>&lt;armure&gt;</code> se désigne comme les accords&nbsp;: "A#" pour La dièse majeur, "Bbm" pour Si bémol mineur, etc.</p>

<p><a name="mark_tempo"></a></p>

<h2>Indication du tempo</h2>

<h3>Tempo pour la valeur de la noire</h3>

<pre><code>SCORE::tempo = &lt;tempo|tempo name&gt;
</code></pre>

<p>Par exemple :</p>

<pre><code>SCORE::tempo = 126

SCORE::tempo = "Andante"
</code></pre>

<h3>Tempo pour une valeur autre que noire</h3>

<pre><code>SCORE::tempo = {:duree =&gt; &lt;durée&gt;, :tempo =&gt; &lt;tempo&gt;, :name =&gt; &lt;nom tempo&gt;}
</code></pre>

<p>Par exemple, pour mettre la croche (8) à 60&nbsp;:</p>

<pre><code>SCORE::tempo = {:duree =&gt; 8, :tempo =&gt; 60, :name =&gt; "Allegro"}
</code></pre>

<p><a name="mark_instrument"></a></p>

<h2>Définir l'instrument</h2>

<pre><code>SCORE::instrument = &lt;instrument&gt;
</code></pre>

<p><a name="define_espace_avant_premier_systeme"></a></p>

<h2>Définir l'espace entre titre et premier système</h2>

<pre><code>SCORE::espace_titre_systemes = &lt;valeur&gt;
</code></pre>

<p><a name="define_systeme_spacing"></a></p>

<h2>Définir l'espacement entre les systèmes</h2>

<pre><code>SCORE::espace_entre_systemes = &lt;valeur&gt;
</code></pre>

<p><a name="define_espace_entre_portees"></a></p>

<h2>Définir l'espace entre les portées</h2>

<pre><code>SCORE::espace_entre_portees = &lt;valeur&gt; # défaut : 3 (ne pas mettre une valeur trop grande)
</code></pre>

<p><a name="define_score_size"></a></p>

<h2>Définir la taille de la partition</h2>

<pre><code>SCORE::taille = &lt;valeur&gt;
</code></pre>

<p>Où <code>&lt;valeur&gt;</code> peut être&nbsp;:</p>

<pre><code>PARTITION_CLASSIQUE/20    Taille normale pour les partitions classiques
LIVRET_POCHE/11           Les livrets de poche
13, 14, 16
LIVRE_CHANT / 18          Les livres de chant
23 et 26
</code></pre>

<p><a name="write_code_partition"></a></p>

<h1>Écrire le code de la partition</h1>

<h2>Concaténation</h2>

<p>Pour éviter les erreurs en additionnant des strings, la class <code>String</code> a été modifiée&nbsp;:</p>

<pre><code>"a" + "b"   =&gt; "a b"
"a" &lt;&lt; "b"  =&gt; "a b"
</code></pre>

<p>Donc il est inutile de terminer ou de commencer les strings de notes par des espaces.</p>

<p><a name="options_fonctions_music"></a></p>

<h2>Options pour les fonctions musicales</h2>

<p>Ces options sont le second argument de toutes les fonctions musicales. Elles peuvent définir&nbsp;:</p>

<pre><code>:duree        La durée de la note/des notes
:octave       L'octave (note : en notation anglosaxone, donc le DO sous la portée
              de Sol est un Do 4)
:doigte       Le doigté à utiliser
:jeu          Le mode de jeu, défini explicitement avec du code 
              lilypond (".", "-", etc.) ou les constantes textuelles
</code></pre>

<p><a name='write_notes'></a></p>

<h2>Écriture des notes</h2>

<p>Les notes s'écrivent comme dans Lilypond, à l'aide de <strong>lettres minuscules de <code>a</code> à <code>g</code>.</strong></p>

<p>Pour les altérations, on peut utiliser la notation lilypond&nbsp;:</p>

<pre><code>ais =&gt; la dièse
aes =&gt; la bémol
</code></pre>

<p>… ou la notation avec <code>#</code> et <code>b</code>&nbsp;:</p>

<pre><code>a#  =&gt; la dièse
ab  =&gt; la bémol
bb  =&gt; si bémol
</code></pre>

<p><a name="les_barres_de_mesure"></a></p>

<h2>Écrire les barres de mesure</h2>

<p>L'écriture des barres de mesure dans RLily est très intuitive.</p>

<p>Pour une <strong>double barre</strong>, ils suffit d'écrire… une double-barre&nbsp;:</p>

<pre><code>c a || b c
</code></pre>

<p>Pour la <strong>barre de fin</strong>&nbsp;:</p>

<pre><code>c a f ||.
</code></pre>

<p>Pour une <strong>reprise simple</strong> :</p>

<pre><code>|: c d e f :|
</code></pre>

<p>Pour une <strong>double reprise</strong>&nbsp;:</p>

<pre><code>|: c d e f :|: f e d c :|
</code></pre>

<p>Pour une <strong>reprise avec alternative</strong></p>

<pre><code>|: &lt;notes&gt; |1 &lt;notes première fois&gt; :|2 &lt;notes deuxième fois&gt; ||
</code></pre>

<p>Plusieurs choses sont à noter ici&nbsp;:</p>

<ul>
<li><p>Seules 2 alternatives sont possibles avec cette écriture. S'il doit y en avoir plus, utiliser le code normal de Lilipond&nbsp;:</p>

<pre><code>\repeat volta &lt;x fois&gt; {
  &lt;notes&gt;
}
\alternative {
  { &lt;première fois }
  { &lt;première alternative }
  { &lt;deuxième alternative }
  ...
  { &lt;dernière fois&gt; }
}
</code></pre></li>
<li><p>La fin de la deuxième alternative doit <u>obligatoirement</u> être indiquée par une double barre (<code>||</code>). Mais cette double-barre ne sera pas "écrite". Pour avoir réellement une double-barre sur la partition, il faut donc la répéter&nbsp;:</p>

<pre><code>|: c |1 d :|2 e || ||
</code></pre></li>
</ul>


<p><a name="define_octave"></a></p>

<h2>Définir l'octave</h2>

<p>Si des variables sont employées pour simplifier le code et le rendre plus explicite, il est bon de définir l'octave précise des motifs pour qu'ils puissent être enchainés. On utilise pour ça la fonction <code>rel</code> (pour "relative")&nbsp;:</p>

<pre><code>rel(&lt;notes&gt;, &lt;octave&gt;)
# La première des &lt;notes&gt; commencera toujours à l'octave &lt;octave&gt;
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>rel("c e g", 5)
# =&gt; \relative c''{ c e g }
</code></pre>

<p>Note&nbsp;: Pour définir une écriture avec "8ve----", cf. <a href="#write_a_loctave">Écrire à l'octave</a>.</p>

<p><a name="define_cle"></a></p>

<h2>Définir la clé</h2>

<pre><code>MD &lt;&lt; &lt;clé&gt;
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code># Par constante (cf. ci-dessous)
MD &lt;&lt; CLE_FA

# Explicitement
MD &lt;&lt; "\\clef \"bass\""
</code></pre>

<p>Constantes&nbsp;:</p>

<pre><code>CLE_F/CLE_FA      Clé de fa
CLE_G/CLE_SOL     Clé de sol
</code></pre>

<p><a name="write_chord"></a></p>

<h2>Écrire un accord</h2>

<pre><code>chord(&lt;"notes"|[notes]&gt;[, &lt;options&gt;])
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; chord("c e g")
# =&gt; "&lt;c e g&gt;"

MD &lt;&lt; chord([c, E, g], :duree =&gt; 8)
# =&gt; "&lt;c e g&gt;8"
# Noter que les notes peuvent être définies par des minuscules ou des majuscules

MD &lt;&lt; chord("c e g", {:duree =&gt; 4, :jeu =&gt; PIQUE})
# =&gt; "&lt;c e g&gt;4-."
</code></pre>

<p>Pour les <code>&lt;options&gt;</code>, cf. <a href="#options_fonctions_music">Options pour les fonctions musicales</a></p>

<p><a name="write_triolet"></a></p>

<h2>Écrire un triolet</h2>

<pre><code>triolet(&lt;notes&gt;[, &lt;options&gt;])
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; triolet([c, d, e])
# =&gt; "\tuplet 3/2 { c d e }"

MD &lt;&lt; triolet("c d e", :duree =&gt; 16)
# =&gt; "\tuplet 3/2 { c16 d e }"
</code></pre>

<p>Pour les <code>&lt;options&gt;</code>, cf. <a href="#options_fonctions_music">Options pour les fonctions musicales</a></p>

<p><a name="write_a_loctave"></a></p>

<h2>Écrire à l'octave</h2>

<pre><code>octave(&lt;notes&gt;[, &lt;nombre d'octave (1 par défaut)&gt;])
</code></pre>

<p>Par exemple&nbsp;:</p>

<pre><code>MD &lt;&lt; octave("c'' e f g")
# =&gt; Ecrit les notes une octave en dessous, avec la marque "8ve-----"

MD &lt;&lt; octave("c''' e f g", 2)
# =&gt; Ecrit les notes une octave en dessous, avec la marque "15ma-----"
</code></pre>

<p><a name="set_options"></a></p>

<h2>Réglage des options</h2>

<p><a name="option_show_spacing"></a></p>

<h3>Demander l'affichage des dimensions</h3>

<pre><code>SCORE::option :display_spacing =&gt; true

ou

SCORE::option :display_spacing, true
</code></pre>

<p><a name="option_slash_between_systemes"></a></p>

<h3>Ajouter un slash entre les systèmes</h3>

<pre><code>SCORE::option :slash_between_systemes =&gt; true
</code></pre>
</body>
</html>